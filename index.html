<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bastos Lanches PDV</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #FFD700 0%, #DC143C 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo-section {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 10px;
        }

        .logo-placeholder {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #DC143C, #FFD700);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .logo-real {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #DC143C;
            box-shadow: 0 4px 15px rgba(220, 20, 60, 0.3);
        }

        h1 {
            color: #2c3e50;
            font-size: 2.5em;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.2em;
            margin-top: 5px;
        }

        .main-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .menu-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .menu-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 1);
            border: 2px solid #FFD700;
        }

        .menu-icon {
            font-size: 3em;
            margin-bottom: 15px;
            display: block;
        }

        .menu-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .menu-card p {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .content-area {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: none;
        }

        .content-area.active {
            display: block;
        }

        .btn {
            background: linear-gradient(45deg, #DC143C, #B22222);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            filter: brightness(1.1);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
        }

        .btn-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }

        .btn-success {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #333;
            font-weight: bold;
        }

        .btn-small {
            padding: 5px 10px;
            font-size: 0.8em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #DC143C;
            box-shadow: 0 0 0 3px rgba(220, 20, 60, 0.1);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .table th {
            background: linear-gradient(45deg, #DC143C, #B22222);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .table td {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .table tr:hover {
            background-color: #fff8dc;
        }

        .carrinho {
            background: linear-gradient(45deg, #FFD700, #FFFF99);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            color: #333;
            border: 2px solid #DC143C;
        }

        .carrinho h3 {
            margin-bottom: 15px;
            color: #333;
            font-weight: bold;
        }

        .carrinho-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(220, 20, 60, 0.2);
            animation: fadeIn 0.3s ease;
        }

        .carrinho-total {
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            margin-top: 15px;
            color: #333;
            background: rgba(220, 20, 60, 0.1);
            padding: 10px;
            border-radius: 8px;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: 500;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(255, 215, 0, 0.9);
            border: 2px solid #DC143C;
            border-radius: 50px;
            padding: 15px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            transform: scale(1.1);
            background: #FFD700;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #333;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid #DC143C;
            box-shadow: 0 4px 15px rgba(220, 20, 60, 0.2);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #DC143C;
        }

        .payment-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .payment-method {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .payment-method:hover, .payment-method.selected {
            border-color: #DC143C;
            background: linear-gradient(45deg, #DC143C, #B22222);
            color: white;
        }

        .chart-bar {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #DC143C;
        }

        .chart-date {
            width: 100px;
            font-weight: bold;
            color: #2c3e50;
        }

        .chart-value {
            flex: 1;
            height: 20px;
            background: linear-gradient(90deg, #FFD700, #DC143C);
            border-radius: 10px;
            margin: 0 15px;
        }

        .chart-amount {
            font-weight: bold;
            color: #DC143C;
        }

        .upload-area {
            border: 2px dashed #DC143C;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            background: #fff8dc;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            background: #ffebcd;
            border-color: #FFD700;
        }

        .upload-area.dragover {
            background: #FFD700;
            border-color: #DC143C;
        }

        .produto-actions {
            display: flex;
            gap: 5px;
        }

        .encomenda-card {
            background: white;
            border: 2px solid #FFD700;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .encomenda-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .status-pago {
            background: #28a745;
            color: white;
            padding: 3px 8px;
            border-radius: 15px;
            font-size: 0.8em;
        }

        .status-pendente {
            background: #ffc107;
            color: black;
            padding: 3px 8px;
            border-radius: 15px;
            font-size: 0.8em;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 3px solid #FFD700;
        }

        .carrinho input {
            border: 2px solid #DC143C;
            background: white;
            color: #333;
        }

        .carrinho input:focus {
            border-color: #FFD700;
            background: #fffacd;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .main-menu {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            
            .logo-section {
                flex-direction: column;
                gap: 10px;
            }

            .back-btn {
                padding: 10px;
                top: 10px;
                left: 10px;
            }
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-section">
                <div id="logo-container">
                    <div class="logo-placeholder" id="logo-placeholder">BL</div>
                </div>
                <div>
                    <h1 id="titulo-empresa">Bastos Lanches</h1>
                    <p class="subtitle" id="subtitulo-sistema">Sistema de Venda Bastos</p>
                </div>
            </div>
        </div>

        <button class="back-btn" onclick="voltarMenu()" style="display: none;">
            <span style="font-size: 1.5em; color: #DC143C;">‚Üê</span>
        </button>

        <div id="main-menu" class="main-menu">
            <div class="menu-card" onclick="mostrarSecao('cadastro-produto')">
                <span class="menu-icon">üì¶</span>
                <h3>Cadastrar Produto</h3>
                <p>Adicione novos produtos ao sistema</p>
            </div>
            <div class="menu-card" onclick="mostrarSecao('listar-produtos')">
                <span class="menu-icon">üìã</span>
                <h3>Listar Produtos</h3>
                <p>Visualize todos os produtos cadastrados</p>
            </div>
            <div class="menu-card" onclick="mostrarSecao('nova-venda')">
                <span class="menu-icon">üõí</span>
                <h3>Nova Venda</h3>
                <p>Inicie uma nova venda</p>
            </div>
            <div class="menu-card" onclick="mostrarSecao('relatorios')">
                <span class="menu-icon">üìä</span>
                <h3>Relat√≥rios</h3>
                <p>Visualize relat√≥rios de vendas</p>
            </div>
            <div class="menu-card" onclick="mostrarSecao('encomendas')">
                <span class="menu-icon">üìã</span>
                <h3>Encomendas</h3>
                <p>Gerencie pedidos e entregas</p>
            </div>
            <div class="menu-card" onclick="mostrarSecao('ajustes')">
                <span class="menu-icon">‚öôÔ∏è</span>
                <h3>Ajustes</h3>
                <p>Configure o sistema</p>
            </div>
        </div>

        <!-- Se√ß√£o Cadastro de Produto -->
        <div id="cadastro-produto" class="content-area">
            <h2>üì¶ Cadastrar Produto</h2>
            <form id="form-produto">
                <div class="form-group">
                    <label for="nome-produto">Nome do Produto:</label>
                    <input type="text" id="nome-produto" required>
                </div>
                <div class="form-group">
                    <label for="preco-produto">Pre√ßo (R$):</label>
                    <input type="number" id="preco-produto" step="0.01" min="0" max="1000000" required>
                </div>
                <div class="form-group">
                    <label for="estoque-produto">Estoque (deixe vazio para ilimitado, m√°ximo 1.000.000):</label>
                    <input type="number" id="estoque-produto" min="0" max="1000000">
                </div>
                <button type="submit" class="btn btn-success">Cadastrar Produto</button>
            </form>
        </div>

        <!-- Se√ß√£o Listar Produtos -->
        <div id="listar-produtos" class="content-area">
            <h2>üìã Produtos Cadastrados</h2>
            <div style="margin-bottom: 20px;">
                <button onclick="mostrarModalProduto()" class="btn btn-success">+ Novo Produto</button>
                <button onclick="exportarProdutos()" class="btn btn-secondary">üìä Exportar Produtos</button>
            </div>
            <div id="lista-produtos"></div>
        </div>

        <!-- Se√ß√£o Encomendas -->
        <div id="encomendas" class="content-area">
            <h2>üìã Gerenciar Encomendas</h2>
            <div style="margin-bottom: 20px;">
                <button onclick="mostrarModalEncomenda()" class="btn btn-success">+ Nova Encomenda</button>
                <button onclick="exportarEncomendas()" class="btn btn-secondary">üìä Exportar Encomendas</button>
            </div>
            
            <div style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
                <select id="filtro-status-encomenda" onchange="filtrarEncomendas()" style="padding: 10px; border-radius: 5px; border: 2px solid #e0e0e0;">
                    <option value="">Todos os Status</option>
                    <option value="pendente">Pendente</option>
                    <option value="pago">Pago</option>
                </select>
                <input type="date" id="filtro-data-entrega" onchange="filtrarEncomendas()" style="padding: 10px; border-radius: 5px; border: 2px solid #e0e0e0;">
                <button onclick="limparFiltrosEncomenda()" class="btn">üîÑ Limpar Filtros</button>
            </div>
            
            <div id="lista-encomendas"></div>
        </div>

        <!-- Se√ß√£o Nova Venda -->
        <div id="nova-venda" class="content-area">
            <h2>üõí Nova Venda</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <div>
                    <h3>Adicionar Produto</h3>
                    <div class="form-group">
                        <label for="produto-venda">Produto:</label>
                        <select id="produto-venda">
                            <option value="">Selecione um produto</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="quantidade-venda">Quantidade:</label>
                        <input type="number" id="quantidade-venda" min="1" value="1">
                    </div>
                    <button onclick="adicionarAoCarrinho()" class="btn">Adicionar ao Carrinho</button>
                </div>
                <div>
                    <div class="carrinho">
                        <h3>üõí Carrinho</h3>
                        <div id="carrinho-itens"></div>
                        <div class="carrinho-total" id="carrinho-total">Total: R$ 0,00</div>
                        <div style="text-align: center; margin-top: 20px;">
                            <button onclick="finalizarVenda()" class="btn btn-success">Finalizar Venda</button>
                            <button onclick="limparCarrinho()" class="btn btn-danger">Limpar Carrinho</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Se√ß√£o Relat√≥rios -->
        <div id="relatorios" class="content-area">
            <h2>üìä Relat√≥rios de Vendas</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-vendas">0</div>
                    <div>Total de Vendas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="vendas-hoje">R$ 0,00</div>
                    <div>Vendas Hoje</div>
                </div>
            </div>
            <div style="margin: 20px 0;">
                <h3 style="color: #DC143C;">Vendas por Data</h3>
                <div style="display: flex; gap: 15px; margin: 15px 0; flex-wrap: wrap;">
                    <div class="form-group" style="max-width: 200px; margin: 0;">
                        <label for="filtro-data">Filtrar por data:</label>
                        <input type="date" id="filtro-data" onchange="filtrarVendasPorData()">
                    </div>
                    <div style="display: flex; gap: 10px; align-items: end;">
                        <button onclick="exportarDados()" class="btn btn-secondary">üìä Exportar Dados</button>
                        <button onclick="limparFiltros()" class="btn">üîÑ Limpar Filtros</button>
                        <button onclick="apagarDadosAntigos()" class="btn btn-danger">üóëÔ∏è Limpar Dados Antigos</button>
                    </div>
                </div>
            </div>
            <div id="lista-vendas"></div>
            <div style="margin: 30px 0;">
                <h3 style="color: #DC143C;">Gr√°fico de Vendas</h3>
                <div id="grafico-vendas"></div>
            </div>
        </div>

        <!-- Se√ß√£o Ajustes -->
        <div id="ajustes" class="content-area">
            <h2>‚öôÔ∏è Configura√ß√µes do Sistema</h2>
            
            <!-- Configura√ß√µes Gerais -->
            <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 2px solid #FFD700;">
                <h3 style="color: #DC143C; margin-bottom: 15px;">üè™ Informa√ß√µes da Empresa</h3>
                <div class="form-group">
                    <label for="nome-sistema">Nome do Sistema:</label>
                    <input type="text" id="nome-sistema" placeholder="Ex: Bastos Lanches PDV">
                </div>
                <div class="form-group">
                    <label for="nome-empresa">Nome da Empresa:</label>
                    <input type="text" id="nome-empresa" placeholder="Ex: Bastos Lanches">
                </div>
                <div class="form-group">
                    <label for="url-logo">URL da Logo:</label>
                    <input type="url" id="url-logo" placeholder="https://exemplo.com/logo.png">
                </div>
                <div class="form-group">
                    <label for="file-logo">Upload da Logo:</label>
                    <div class="upload-area" id="upload-logo" onclick="document.getElementById('file-logo').click()">
                        <input type="file" id="file-logo" accept="image/*" style="display: none;" onchange="carregarLogo(event)">
                        <div id="upload-text">
                            <p>üìÅ Clique ou arraste uma imagem</p>
                            <p style="font-size: 0.9em; color: #666;">Formatos: JPG, PNG, GIF</p>
                        </div>
                    </div>
                </div>
                <button onclick="salvarConfiguracoesGerais()" class="btn btn-success">Salvar Configura√ß√µes</button>
            </div>

            <!-- Configura√ß√µes PIX -->
            <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 2px solid #FFD700;">
                <h3 style="color: #DC143C; margin-bottom: 15px;">üì± Configura√ß√µes PIX</h3>
                <div class="form-group">
                    <label for="chave-pix">Chave PIX:</label>
                    <input type="text" id="chave-pix" placeholder="Ex: 11999999999 ou email@exemplo.com">
                </div>
                <div class="form-group">
                    <label for="nome-pix">Nome do Recebedor:</label>
                    <input type="text" id="nome-pix" placeholder="Ex: Jo√£o Silva">
                </div>
                <div class="form-group">
                    <label for="cidade-pix">Cidade:</label>
                    <input type="text" id="cidade-pix" placeholder="Ex: S√£o Paulo">
                </div>
                <div class="form-group">
                    <label for="banco-pix">Banco (opcional):</label>
                    <input type="text" id="banco-pix" placeholder="Ex: Banco do Brasil">
                </div>
                <button onclick="salvarConfiguracoesPix()" class="btn btn-success">Salvar PIX</button>
                <button onclick="testarQRCode()" class="btn btn-secondary">üîç Testar QR Code</button>
            </div>

            <!-- Preview das Configura√ß√µes -->
            <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #FFD700;">
                <h3 style="color: #DC143C; margin-bottom: 15px;">üëÄ Preview</h3>
                <div id="preview-configuracoes">
                    <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                        <div id="preview-logo" style="margin-bottom: 10px;">
                            <div class="logo-placeholder">BL</div>
                        </div>
                        <h4 id="preview-nome-empresa">Bastos Lanches</h4>
                        <p id="preview-nome-sistema">Sistema de Venda Bastos</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal de Finaliza√ß√£o -->
        <div id="modal-finalizacao" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000;">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; max-width: 500px; width: 90%; border: 3px solid #FFD700;">
                <h3 style="color: #DC143C;">üí≥ Finalizar Venda</h3>
                <div id="resumo-venda"></div>
                <h4 style="color: #DC143C;">Forma de Pagamento:</h4>
                <div class="payment-methods">
                    <div class="payment-method" onclick="selecionarPagamento('pix')">
                        <div style="font-size: 2em;">üì±</div>
                        <div>PIX</div>
                    </div>
                    <div class="payment-method" onclick="selecionarPagamento('cartao')">
                        <div style="font-size: 2em;">üí≥</div>
                        <div>Cart√£o</div>
                    </div>
                    <div class="payment-method" onclick="selecionarPagamento('dinheiro')">
                        <div style="font-size: 2em;">üíµ</div>
                        <div>Dinheiro</div>
                    </div>
                </div>
                <div id="pagamento-pix" style="display: none;">
                    <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 10px; margin: 15px 0;">
                        <h4 style="color: #DC143C; margin-bottom: 15px;">üì± Pagamento PIX</h4>
                        <div id="qr-code-container" style="margin: 20px 0;">
                            <div id="qr-code-placeholder" style="width: 200px; height: 200px; background: #e9ecef; border: 2px dashed #ccc; margin: 0 auto; display: flex; align-items: center; justify-content: center; border-radius: 10px;">
                                <span style="color: #6c757d;">QR Code ser√° gerado aqui</span>
                            </div>
                        </div>
                        <div id="info-pix" style="background: white; padding: 15px; border-radius: 8px; border: 2px solid #FFD700;">
                            <p><strong>Valor:</strong> R$ <span id="valor-pix">0,00</span></p>
                            <p id="nome-recebedor-pix"><strong>Recebedor:</strong> Configure nas Ajustes</p>
                            <p id="banco-info-pix"></p>
                        </div>
                        <p style="margin-top: 10px; font-size: 0.9em; color: #6c757d;">
                            Aponte a c√¢mera do seu celular para o QR Code ou copie a chave PIX
                        </p>
                    </div>
                </div>
                <div id="pagamento-dinheiro" style="display: none;">
                    <div class="form-group">
                        <label for="valor-pago">Valor Pago (R$):</label>
                        <input type="number" id="valor-pago" step="0.01" min="0">
                    </div>
                    <div id="troco-info"></div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button onclick="confirmarVenda()" class="btn btn-success">Confirmar Venda</button>
                    <button onclick="fecharModal()" class="btn btn-secondary">Cancelar</button>
                </div>
            </div>
        </div>

        <!-- Modal Editar Produto -->
        <div id="modal-produto" style="display: none;" class="modal-overlay">
            <div class="modal-content">
                <h3 style="color: #DC143C;">‚úèÔ∏è Editar Produto</h3>
                <form id="form-editar-produto">
                    <input type="hidden" id="edit-produto-id">
                    <div class="form-group">
                        <label for="edit-nome-produto">Nome do Produto:</label>
                        <input type="text" id="edit-nome-produto" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-preco-produto">Pre√ßo (R$):</label>
                        <input type="number" id="edit-preco-produto" step="0.01" min="0" max="1000000" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-estoque-produto">Estoque:</label>
                        <input type="number" id="edit-estoque-produto" min="0" max="1000000">
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button type="submit" class="btn btn-success">Salvar</button>
                        <button type="button" onclick="fecharModalProduto()" class="btn btn-secondary">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal Nova Encomenda -->
        <div id="modal-encomenda" style="display: none;" class="modal-overlay">
            <div class="modal-content">
                <h3 style="color: #DC143C;">üìù Nova Encomenda</h3>
                <form id="form-encomenda">
                    <div class="form-group">
                        <label for="nome-cliente">Nome do Cliente:</label>
                        <input type="text" id="nome-cliente" required>
                    </div>
                    <div class="form-group">
                        <label for="telefone-cliente">Telefone:</label>
                        <input type="tel" id="telefone-cliente">
                    </div>
                    <div class="form-group">
                        <label for="descricao-encomenda">Descri√ß√£o da Encomenda:</label>
                        <textarea id="descricao-encomenda" rows="3" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="valor-encomenda">Valor Total (R$):</label>
                        <input type="number" id="valor-encomenda" step="0.01" min="0" max="1000000" required>
                    </div>
                    <div class="form-group">
                        <label for="data-entrega">Data de Entrega:</label>
                        <input type="date" id="data-entrega" required>
                    </div>
                    <div class="form-group">
                        <label for="status-pagamento">Status do Pagamento:</label>
                        <select id="status-pagamento">
                            <option value="pendente">Pendente</option>
                            <option value="pago">Pago</option>
                        </select>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button type="submit" class="btn btn-success">Criar Encomenda</button>
                        <button type="button" onclick="fecharModalEncomenda()" class="btn btn-secondary">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>

        <div id="alert-container" style="position: fixed; top: 20px; right: 20px; z-index: 3000;"></div>
    </div>

    <script>
        // Dados em mem√≥ria
        let produtos = [];
        let vendas = [];
        let encomendas = [];
        let carrinho = [];
        let nextId = 1;
        let nextVendaId = 1;
        let nextEncomendaId = 1;
        let formaPagamentoSelecionada = '';
        let totalCarrinho = 0;

        // Configura√ß√µes do sistema
        let configuracoes = {
            nomeEmpresa: 'Bastos Lanches',
            nomeSistema: 'Sistema de Venda Bastos',
            urlLogo: '',
            chavePix: '',
            nomePix: '',
            cidadePix: '',
            bancoPix: ''
        };

        // Fun√ß√µes de navega√ß√£o
        function mostrarSecao(secaoId) {
            document.getElementById('main-menu').style.display = 'none';
            document.querySelector('.back-btn').style.display = 'block';
            
            const secoes = document.querySelectorAll('.content-area');
            secoes.forEach(s => s.classList.remove('active'));
            
            document.getElementById(secaoId).classList.add('active');
            
            if (secaoId === 'listar-produtos') {
                carregarListaProdutos();
            } else if (secaoId === 'nova-venda') {
                carregarProdutosVenda();
                atualizarCarrinho();
            } else if (secaoId === 'relatorios') {
                carregarRelatorios();
            } else if (secaoId === 'ajustes') {
                carregarAjustes();
            } else if (secaoId === 'encomendas') {
                carregarEncomendas();
            }
        }

        function voltarMenu() {
            document.getElementById('main-menu').style.display = 'grid';
            document.querySelector('.back-btn').style.display = 'none';
            
            const secoes = document.querySelectorAll('.content-area');
            secoes.forEach(s => s.classList.remove('active'));
        }

        function mostrarAlert(mensagem, tipo = 'success') {
            const alert = document.createElement('div');
            alert.className = `alert alert-${tipo}`;
            alert.textContent = mensagem;
            alert.style.cssText = `
                position: relative;
                padding: 15px;
                border-radius: 8px;
                margin: 10px 0;
                font-weight: 500;
                animation: slideIn 0.3s ease;
                min-width: 300px;
                border: 2px solid ${tipo === 'success' ? '#FFD700' : '#DC143C'};
            `;
            
            if (tipo === 'success') {
                alert.style.background = '#d4edda';
                alert.style.color = '#155724';
            } else {
                alert.style.background = '#f8d7da';
                alert.style.color = '#721c24';
            }
            
            const container = document.getElementById('alert-container');
            container.appendChild(alert);
            
            setTimeout(() => {
                if (container.contains(alert)) {
                    container.removeChild(alert);
                }
            }, 3000);
        }

        function validarEstoque(produtoId, quantidadeSolicitada) {
            const produto = produtos.find(p => p.id === produtoId);
            if (!produto) return false;
            
            if (produto.estoque === null || produto.estoque === undefined) return true;
            
            const quantidadeNoCarrinho = carrinho
                .filter(item => item.id === produtoId)
                .reduce((total, item) => total + item.quantidade, 0);
            
            const estoqueDisponivel = produto.estoque - quantidadeNoCarrinho;
            return quantidadeSolicitada <= estoqueDisponivel;
        }

        // Cadastro de Produtos
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('form-produto').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const nome = document.getElementById('nome-produto').value.trim();
                const preco = parseFloat(document.getElementById('preco-produto').value);
                const estoque = document.getElementById('estoque-produto').value;
                
                if (!nome || preco <= 0 || preco > 1000000) {
                    mostrarAlert('Preencha todos os campos corretamente! Pre√ßo m√°ximo: R$ 1.000.000', 'error');
                    return;
                }

                if (estoque !== '' && (parseInt(estoque) < 0 || parseInt(estoque) > 1000000)) {
                    mostrarAlert('Estoque deve ser entre 0 e 1.000.000!', 'error');
                    return;
                }
                
                const produto = {
                    id: nextId++,
                    nome: nome,
                    preco: preco,
                    estoque: estoque === '' ? null : parseInt(estoque)
                };
                
                produtos.push(produto);
                mostrarAlert(`Produto "${nome}" cadastrado com sucesso!`);
                this.reset();
            });

            // Form de editar produto
            document.getElementById('form-editar-produto').addEventListener('submit', function(e) {
                e.preventDefault();
                salvarEdicaoProduto();
            });

            // Form de encomenda
            document.getElementById('form-encomenda').addEventListener('submit', function(e) {
                e.preventDefault();
                criarEncomenda();
            });

            // Configurar drag and drop para logo
            const uploadArea = document.getElementById('upload-logo');
            if (uploadArea) {
                uploadArea.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('dragover');
                });
                
                uploadArea.addEventListener('dragleave', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                });
                
                uploadArea.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        const file = files[0];
                        if (file.type.startsWith('image/')) {
                            document.getElementById('file-logo').files = files;
                            carregarLogo({ target: { files: files } });
                        } else {
                            mostrarAlert('Por favor, selecione apenas arquivos de imagem!', 'error');
                        }
                    }
                });
            }
        });

        function carregarListaProdutos() {
            const container = document.getElementById('lista-produtos');
            
            if (produtos.length === 0) {
                container.innerHTML = '<p>Nenhum produto cadastrado. Use o bot√£o "Novo Produto" para adicionar produtos.</p>';
                return;
            }
            
            let html = '<table class="table"><thead><tr><th>ID</th><th>Nome</th><th>Pre√ßo</th><th>Estoque</th><th>A√ß√µes</th></tr></thead><tbody>';
            
            produtos.forEach(produto => {
                html += `
                    <tr>
                        <td>${produto.id}</td>
                        <td>${produto.nome}</td>
                        <td>R$ ${produto.preco.toFixed(2)}</td>
                        <td>${produto.estoque === null ? '‚àû' : produto.estoque}</td>
                        <td class="produto-actions">
                            <button onclick="editarProduto(${produto.id})" class="btn btn-small" style="background: #FFD700; color: #333;">‚úèÔ∏è</button>
                            <button onclick="excluirProduto(${produto.id})" class="btn btn-danger btn-small">üóëÔ∏è</button>
                        </td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }

        function mostrarModalProduto() {
            document.getElementById('modal-produto').style.display = 'flex';
            document.getElementById('edit-produto-id').value = '';
            document.getElementById('form-editar-produto').reset();
        }

        function fecharModalProduto() {
            document.getElementById('modal-produto').style.display = 'none';
        }

        function editarProduto(id) {
            const produto = produtos.find(p => p.id === id);
            if (!produto) return;
            
            document.getElementById('edit-produto-id').value = produto.id;
            document.getElementById('edit-nome-produto').value = produto.nome;
            document.getElementById('edit-preco-produto').value = produto.preco;
            document.getElementById('edit-estoque-produto').value = produto.estoque || '';
            
            document.getElementById('modal-produto').style.display = 'flex';
        }

        function salvarEdicaoProduto() {
            const id = parseInt(document.getElementById('edit-produto-id').value);
            const nome = document.getElementById('edit-nome-produto').value.trim();
            const preco = parseFloat(document.getElementById('edit-preco-produto').value);
            const estoque = document.getElementById('edit-estoque-produto').value;
            
            if (!nome || preco <= 0 || preco > 1000000) {
                mostrarAlert('Preencha todos os campos corretamente!', 'error');
                return;
            }
            
            const produtoIndex = produtos.findIndex(p => p.id === id);
            if (produtoIndex === -1) return;
            
            produtos[produtoIndex] = {
                id: id,
                nome: nome,
                preco: preco,
                estoque: estoque === '' ? null : parseInt(estoque)
            };
            
            mostrarAlert('Produto atualizado com sucesso!');
            fecharModalProduto();
            carregarListaProdutos();
        }

        function excluirProduto(id) {
            if (confirm('Tem certeza que deseja excluir este produto?')) {
                produtos = produtos.filter(p => p.id !== id);
                carregarListaProdutos();
                mostrarAlert('Produto exclu√≠do com sucesso!');
            }
        }

        function exportarProdutos() {
            if (produtos.length === 0) {
                mostrarAlert('Nenhum produto para exportar!', 'error');
                return;
            }
            
            const dados = {
                produtos: produtos,
                dataExportacao: new Date().toISOString(),
                total: produtos.length
            };
            
            const jsonString = JSON.stringify(dados, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `produtos_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            URL.revokeObjectURL(url);
            mostrarAlert('Produtos exportados com sucesso!');
        }

        function carregarProdutosVenda() {
            const select = document.getElementById('produto-venda');
            select.innerHTML = '<option value="">Selecione um produto</option>';
            
            produtos.forEach(produto => {
                if (produto.estoque === null || produto.estoque > 0) {
                    select.innerHTML += `<option value="${produto.id}">${produto.nome} - R$ ${produto.preco.toFixed(2)}</option>`;
                }
            });
        }

        function adicionarAoCarrinho() {
            const produtoId = parseInt(document.getElementById('produto-venda').value);
            const quantidade = parseInt(document.getElementById('quantidade-venda').value);
            
            if (!produtoId || !quantidade || quantidade <= 0) {
                mostrarAlert('Selecione um produto e quantidade v√°lida!', 'error');
                return;
            }
            
            const produto = produtos.find(p => p.id === produtoId);
            if (!produto) {
                mostrarAlert('Produto n√£o encontrado!', 'error');
                return;
            }
            
            if (!validarEstoque(produtoId, quantidade)) {
                mostrarAlert('Estoque insuficiente!', 'error');
                return;
            }
            
            const itemExistente = carrinho.find(item => item.id === produtoId);
            if (itemExistente) {
                if (!validarEstoque(produtoId, quantidade)) {
                    mostrarAlert('Estoque insuficiente para adicionar mais unidades!', 'error');
                    return;
                }
                itemExistente.quantidade += quantidade;
            } else {
                carrinho.push({
                    id: produto.id,
                    nome: produto.nome,
                    preco: produto.preco,
                    quantidade: quantidade
                });
            }
            
            atualizarCarrinho();
            mostrarAlert(`${quantidade}x ${produto.nome} adicionado ao carrinho!`);
            document.getElementById('quantidade-venda').value = 1;
            document.getElementById('produto-venda').value = '';
        }

        function editarQuantidadeCarrinho(index, novaQuantidade) {
            if (novaQuantidade <= 0) {
                removerDoCarrinho(index);
                return;
            }
            
            const item = carrinho[index];
            const produto = produtos.find(p => p.id === item.id);
            
            if (produto.estoque !== null) {
                const outrosItens = carrinho.filter((_, i) => i !== index && carrinho[i].id === item.id);
                const quantidadeOutros = outrosItens.reduce((total, outroItem) => total + outroItem.quantidade, 0);
                const estoqueDisponivel = produto.estoque - quantidadeOutros;
                
                if (novaQuantidade > estoqueDisponivel) {
                    mostrarAlert('Estoque insuficiente para essa quantidade!', 'error');
                    return;
                }
            }
            
            item.quantidade = novaQuantidade;
            atualizarCarrinho();
            mostrarAlert('Quantidade atualizada!');
        }

        function atualizarCarrinho() {
            const container = document.getElementById('carrinho-itens');
            
            if (carrinho.length === 0) {
                container.innerHTML = '<p>Carrinho vazio</p>';
                totalCarrinho = 0;
            } else {
                let html = '';
                totalCarrinho = 0;
                
                carrinho.forEach((item, index) => {
                    const subtotal = item.quantidade * item.preco;
                    totalCarrinho += subtotal;
                    
                    html += `
                        <div class="carrinho-item">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <input type="number" value="${item.quantidade}" min="1" max="999" 
                                       onchange="editarQuantidadeCarrinho(${index}, parseInt(this.value))"
                                       style="width: 60px; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                                <span>${item.nome}</span>
                            </div>
                            <div>R$ ${subtotal.toFixed(2)}</div>
                            <button onclick="removerDoCarrinho(${index})" class="btn btn-danger" style="padding: 5px 10px; font-size: 12px;">Remover</button>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            }
            
            document.getElementById('carrinho-total').textContent = `Total: R$ ${totalCarrinho.toFixed(2)}`;
        }

        function removerDoCarrinho(index) {
            const item = carrinho[index];
            carrinho.splice(index, 1);
            atualizarCarrinho();
            mostrarAlert(`${item.nome} removido do carrinho!`);
        }

        function limparCarrinho() {
            if (carrinho.length === 0) {
                mostrarAlert('Carrinho j√° est√° vazio!', 'error');
                return;
            }
            carrinho = [];
            atualizarCarrinho();
            mostrarAlert('Carrinho limpo!');
        }

        function finalizarVenda() {
            if (carrinho.length === 0) {
                mostrarAlert('Carrinho est√° vazio!', 'error');
                return;
            }
            
            document.getElementById('modal-finalizacao').style.display = 'block';
            
            let html = '<h4>Resumo da Venda:</h4>';
            carrinho.forEach(item => {
                const subtotal = item.quantidade * item.preco;
                html += `<div style="display: flex; justify-content: space-between; margin: 5px 0;">
                    <span>${item.quantidade}x ${item.nome}</span>
                    <span>R$ ${subtotal.toFixed(2)}</span>
                </div>`;
            });
            html += `<div style="font-weight: bold; margin-top: 15px; padding-top: 10px; border-top: 2px solid #ddd; display: flex; justify-content: space-between;">
                <span>Total:</span>
                <span>R$ ${totalCarrinho.toFixed(2)}</span>
            </div>`;
            
            document.getElementById('resumo-venda').innerHTML = html;
            formaPagamentoSelecionada = '';
            document.getElementById('pagamento-dinheiro').style.display = 'none';
            document.getElementById('pagamento-pix').style.display = 'none';
            document.querySelectorAll('.payment-method').forEach(el => el.classList.remove('selected'));
        }

        function selecionarPagamento(forma) {
            document.querySelectorAll('.payment-method').forEach(el => el.classList.remove('selected'));
            
            event.target.closest('.payment-method').classList.add('selected');
            formaPagamentoSelecionada = forma;
            
            // Esconder todas as se√ß√µes de pagamento
            document.getElementById('pagamento-dinheiro').style.display = 'none';
            document.getElementById('pagamento-pix').style.display = 'none';
            
            if (forma === 'dinheiro') {
                document.getElementById('pagamento-dinheiro').style.display = 'block';
                document.getElementById('valor-pago').value = totalCarrinho.toFixed(2);
                calcularTroco();
                document.getElementById('valor-pago').addEventListener('input', calcularTroco);
            } else if (forma === 'pix') {
                document.getElementById('pagamento-pix').style.display = 'block';
                gerarQRCodePix();
            }
        }

        function calcularTroco() {
            const valorPago = parseFloat(document.getElementById('valor-pago').value) || 0;
            const troco = valorPago - totalCarrinho;
            
            if (valorPago >= totalCarrinho) {
                document.getElementById('troco-info').innerHTML = `<div style="color: green; font-weight: bold; margin-top: 10px;">Troco: R$ ${troco.toFixed(2)}</div>`;
            } else {
                document.getElementById('troco-info').innerHTML = `<div style="color: red; font-weight: bold; margin-top: 10px;">Valor insuficiente! Faltam R$ ${(totalCarrinho - valorPago).toFixed(2)}</div>`;
            }
        }

        function confirmarVenda() {
            if (!formaPagamentoSelecionada) {
                mostrarAlert('Selecione uma forma de pagamento!', 'error');
                return;
            }
            
            let valorPago = totalCarrinho;
            let troco = 0;
            
            if (formaPagamentoSelecionada === 'dinheiro') {
                valorPago = parseFloat(document.getElementById('valor-pago').value) || 0;
                if (valorPago < totalCarrinho) {
                    mostrarAlert('Valor pago insuficiente!', 'error');
                    return;
                }
                troco = valorPago - totalCarrinho;
            }
            
            // Atualizar estoque
            carrinho.forEach(item => {
                const produto = produtos.find(p => p.id === item.id);
                if (produto && produto.estoque !== null) {
                    produto.estoque -= item.quantidade;
                }
            });
            
            // Registrar venda
            const venda = {
                id: nextVendaId++,
                data: new Date().toISOString(),
                itens: carrinho.map(i => `${i.quantidade}x ${i.nome}`).join('; '),
                total: totalCarrinho,
                pago: valorPago,
                troco: troco,
                formaPagamento: formaPagamentoSelecionada
            };
            
            vendas.push(venda);
            
            carrinho = [];
            atualizarCarrinho();
            
            fecharModal();
            mostrarAlert(`Venda #${venda.id} finalizada com sucesso! Troco: R$ ${troco.toFixed(2)}`);
        }

        function fecharModal() {
            document.getElementById('modal-finalizacao').style.display = 'none';
            document.getElementById('valor-pago').value = '';
            document.getElementById('troco-info').innerHTML = '';
            document.querySelectorAll('.payment-method').forEach(el => el.classList.remove('selected'));
        }

        function carregarRelatorios() {
            const relatorio = gerarRelatorioDetalhado();
            
            const statsContainer = document.querySelector('.stats-grid');
            statsContainer.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${relatorio.totalVendas}</div>
                    <div>Total de Vendas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">R$ ${relatorio.totalHoje.toFixed(2)}</div>
                    <div>Vendas Hoje</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">R$ ${relatorio.ticketMedio}</div>
                    <div>Ticket M√©dio</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${relatorio.crescimento}%</div>
                    <div>Crescimento (vs ontem)</div>
                </div>
            `;
            
            if (relatorio.produtoMaisVendido) {
                statsContainer.innerHTML += `
                    <div class="stat-card">
                        <div class="stat-number">${relatorio.produtoMaisVendido[1]}</div>
                        <div>+ Vendido: ${relatorio.produtoMaisVendido[0]}</div>
                    </div>
                `;
            }
            
            carregarListaVendas();
            carregarGraficoVendas();
        }

        function gerarRelatorioDetalhado() {
            const hoje = new Date().toISOString().split('T')[0];
            const ontem = new Date(Date.now() - 86400000).toISOString().split('T')[0];
            
            const vendasHoje = vendas.filter(v => v.data.startsWith(hoje));
            const vendasOntem = vendas.filter(v => v.data.startsWith(ontem));
            
            const totalHoje = vendasHoje.reduce((sum, v) => sum + v.total, 0);
            const totalOntem = vendasOntem.reduce((sum, v) => sum + v.total, 0);
            
            const produtosVendidos = {};
            vendas.forEach(venda => {
                const itens = venda.itens.split('; ');
                itens.forEach(item => {
                    const match = item.match(/(\d+)x (.+)/);
                    if (match) {
                        const quantidade = parseInt(match[1]);
                        const nome = match[2];
                        produtosVendidos[nome] = (produtosVendidos[nome] || 0) + quantidade;
                    }
                });
            });
            
            return {
                totalVendas: vendas.length,
                totalHoje,
                totalOntem,
                crescimento: totalOntem > 0 ? ((totalHoje - totalOntem) / totalOntem * 100).toFixed(1) : 0,
                produtoMaisVendido: Object.entries(produtosVendidos).sort((a, b) => b[1] - a[1])[0],
                ticketMedio: vendas.length > 0 ? (vendas.reduce((sum, v) => sum + v.total, 0) / vendas.length).toFixed(2) : 0
            };
        }

        function carregarListaVendas(dataFiltro = null) {
            const container = document.getElementById('lista-vendas');
            
            let vendasFiltradas = vendas;
            if (dataFiltro) {
                vendasFiltradas = vendas.filter(v => v.data.startsWith(dataFiltro));
            }
            
            if (vendasFiltradas.length === 0) {
                container.innerHTML = '<p>Nenhuma venda encontrada.</p>';
                return;
            }
            
            let html = '<table class="table"><thead><tr><th>ID</th><th>Data/Hora</th><th>Itens</th><th>Total</th><th>Pagamento</th><th>Troco</th></tr></thead><tbody>';
            
            vendasFiltradas.reverse().forEach(venda => {
                const data = new Date(venda.data).toLocaleString('pt-BR');
                html += `
                    <tr>
                        <td>#${venda.id}</td>
                        <td>${data}</td>
                        <td>${venda.itens}</td>
                        <td>R$ ${venda.total.toFixed(2)}</td>
                        <td>${venda.formaPagamento.toUpperCase()}</td>
                        <td>R$ ${venda.troco.toFixed(2)}</td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            
            const totalFiltrado = vendasFiltradas.reduce((sum, v) => sum + v.total, 0);
            html += `<div style="text-align: right; margin-top: 15px; font-weight: bold; font-size: 1.2em;">
                Total: R$ ${totalFiltrado.toFixed(2)} (${vendasFiltradas.length} vendas)
            </div>`;
            
            container.innerHTML = html;
        }

        function filtrarVendasPorData() {
            const data = document.getElementById('filtro-data').value;
            carregarListaVendas(data);
        }

        function limparFiltros() {
            document.getElementById('filtro-data').value = '';
            carregarListaVendas();
        }

        function carregarGraficoVendas() {
            const container = document.getElementById('grafico-vendas');
            
            if (vendas.length === 0) {
                container.innerHTML = '<p>Nenhuma venda para exibir no gr√°fico.</p>';
                return;
            }
            
            const vendasPorDia = {};
            vendas.forEach(venda => {
                const data = venda.data.split('T')[0];
                vendasPorDia[data] = (vendasPorDia[data] || 0) + venda.total;
            });
            
            const maxVenda = Math.max(...Object.values(vendasPorDia));
            
            let html = '';
            Object.entries(vendasPorDia).sort().forEach(([data, total]) => {
                const largura = maxVenda > 0 ? (total / maxVenda) * 100 : 0;
                const dataFormatada = new Date(data + 'T00:00:00').toLocaleDateString('pt-BR');
                
                html += `
                    <div class="chart-bar">
                        <div class="chart-date">${dataFormatada}</div>
                        <div class="chart-value" style="width: ${largura}%"></div>
                        <div class="chart-amount">R$ ${total.toFixed(2)}</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function exportarDados() {
            const dados = {
                produtos,
                vendas,
                encomendas,
                configuracoes,
                relatorio: gerarRelatorioDetalhado(),
                dataExportacao: new Date().toISOString(),
                versao: "Bastos Lanches PDV v1.0"
            };
            
            const jsonString = JSON.stringify(dados, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `bastos_lanches_backup_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            URL.revokeObjectURL(url);
            mostrarAlert('Dados exportados com sucesso!');
        }

        function apagarDadosAntigos() {
            if (confirm('Tem certeza que deseja apagar todos os dados antigos? Esta a√ß√£o n√£o pode ser desfeita!')) {
                produtos = [];
                vendas = [];
                encomendas = [];
                carrinho = [];
                nextId = 1;
                nextVendaId = 1;
                nextEncomendaId = 1;
                mostrarAlert('Dados apagados com sucesso!');
                carregarRelatorios();
            }
        }

        // ==================== FUN√á√ïES DE ENCOMENDAS ====================
        
        function carregarEncomendas() {
            mostrarListaEncomendas();
        }

        function mostrarModalEncomenda() {
            document.getElementById('modal-encomenda').style.display = 'flex';
            document.getElementById('form-encomenda').reset();
            // Definir data m√≠nima como hoje
            document.getElementById('data-entrega').min = new Date().toISOString().split('T')[0];
        }

        function fecharModalEncomenda() {
            document.getElementById('modal-encomenda').style.display = 'none';
        }

        function criarEncomenda() {
            const nomeCliente = document.getElementById('nome-cliente').value.trim();
            const telefone = document.getElementById('telefone-cliente').value.trim();
            const descricao = document.getElementById('descricao-encomenda').value.trim();
            const valor = parseFloat(document.getElementById('valor-encomenda').value);
            const dataEntrega = document.getElementById('data-entrega').value;
            const status = document.getElementById('status-pagamento').value;
            
            if (!nomeCliente || !descricao || !valor || !dataEntrega || valor <= 0) {
                mostrarAlert('Preencha todos os campos obrigat√≥rios!', 'error');
                return;
            }
            
            const encomenda = {
                id: nextEncomendaId++,
                nomeCliente,
                telefone,
                descricao,
                valor,
                dataEntrega,
                status,
                dataCriacao: new Date().toISOString()
            };
            
            encomendas.push(encomenda);
            mostrarAlert('Encomenda criada com sucesso!');
            fecharModalEncomenda();
            mostrarListaEncomendas();
        }

        function mostrarListaEncomendas(encomendasFiltradas = null) {
            const container = document.getElementById('lista-encomendas');
            const lista = encomendasFiltradas || encomendas;
            
            if (lista.length === 0) {
                container.innerHTML = '<p>Nenhuma encomenda encontrada.</p>';
                return;
            }
            
            let html = '';
            lista.forEach(encomenda => {
                const dataEntrega = new Date(encomenda.dataEntrega).toLocaleDateString('pt-BR');
                const statusClass = encomenda.status === 'pago' ? 'status-pago' : 'status-pendente';
                
                html += `
                    <div class="encomenda-card">
                        <div class="encomenda-header">
                            <h4>#${encomenda.id} - ${encomenda.nomeCliente}</h4>
                            <span class="${statusClass}">${encomenda.status.toUpperCase()}</span>
                        </div>
                        <p><strong>Descri√ß√£o:</strong> ${encomenda.descricao}</p>
                        <p><strong>Valor:</strong> R$ ${encomenda.valor.toFixed(2)}</p>
                        <p><strong>Entrega:</strong> ${dataEntrega}</p>
                        ${encomenda.telefone ? `<p><strong>Telefone:</strong> ${encomenda.telefone}</p>` : ''}
                        <div style="margin-top: 10px;">
                            <button onclick="editarStatusEncomenda(${encomenda.id})" class="btn btn-small">üìù Status</button>
                            <button onclick="excluirEncomenda(${encomenda.id})" class="btn btn-danger btn-small">üóëÔ∏è</button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function editarStatusEncomenda(id) {
            const encomenda = encomendas.find(e => e.id === id);
            if (!encomenda) return;
            
            const novoStatus = encomenda.status === 'pendente' ? 'pago' : 'pendente';
            encomenda.status = novoStatus;
            
            mostrarAlert(`Status da encomenda #${id} alterado para ${novoStatus.toUpperCase()}!`);
            mostrarListaEncomendas();
        }

        function excluirEncomenda(id) {
            if (confirm('Tem certeza que deseja excluir esta encomenda?')) {
                encomendas = encomendas.filter(e => e.id !== id);
                mostrarListaEncomendas();
                mostrarAlert('Encomenda exclu√≠da com sucesso!');
            }
        }

        function filtrarEncomendas() {
            const statusFiltro = document.getElementById('filtro-status-encomenda').value;
            const dataFiltro = document.getElementById('filtro-data-entrega').value;
            
            let encomendasFiltradas = encomendas;
            
            if (statusFiltro) {
                encomendasFiltradas = encomendasFiltradas.filter(e => e.status === statusFiltro);
            }
            
            if (dataFiltro) {
                encomendasFiltradas = encomendasFiltradas.filter(e => e.dataEntrega === dataFiltro);
            }
            
            mostrarListaEncomendas(encomendasFiltradas);
        }

        function limparFiltrosEncomenda() {
            document.getElementById('filtro-status-encomenda').value = '';
            document.getElementById('filtro-data-entrega').value = '';
            mostrarListaEncomendas();
        }

        function exportarEncomendas() {
            if (encomendas.length === 0) {
                mostrarAlert('Nenhuma encomenda para exportar!', 'error');
                return;
            }
            
            const dados = {
                encomendas: encomendas,
                dataExportacao: new Date().toISOString(),
                total: encomendas.length
            };
            
            const jsonString = JSON.stringify(dados, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `encomendas_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            URL.revokeObjectURL(url);
            mostrarAlert('Encomendas exportadas com sucesso!');
        }

        // ==================== FUN√á√ïES DE AJUSTES ====================
        
        function carregarAjustes() {
            // Carregar valores atuais nos campos
            document.getElementById('nome-sistema').value = configuracoes.nomeSistema;
            document.getElementById('nome-empresa').value = configuracoes.nomeEmpresa;
            document.getElementById('url-logo').value = configuracoes.urlLogo;
            document.getElementById('chave-pix').value = configuracoes.chavePix;
            document.getElementById('nome-pix').value = configuracoes.nomePix;
            document.getElementById('cidade-pix').value = configuracoes.cidadePix;
            document.getElementById('banco-pix').value = configuracoes.bancoPix;
            
            atualizarPreview();
        }

        function salvarConfiguracoesGerais() {
            configuracoes.nomeSistema = document.getElementById('nome-sistema').value.trim() || 'Sistema PDV';
            configuracoes.nomeEmpresa = document.getElementById('nome-empresa').value.trim() || 'Minha Empresa';
            
            const urlLogo = document.getElementById('url-logo').value.trim();
            if (urlLogo) {
                configuracoes.urlLogo = urlLogo;
            }
            
            atualizarInterface();
            atualizarPreview();
            mostrarAlert('Configura√ß√µes gerais salvas com sucesso!');
        }

        function salvarConfiguracoesPix() {
            configuracoes.chavePix = document.getElementById('chave-pix').value.trim();
            configuracoes.nomePix = document.getElementById('nome-pix').value.trim();
            configuracoes.cidadePix = document.getElementById('cidade-pix').value.trim();
            configuracoes.bancoPix = document.getElementById('banco-pix').value.trim();
            
            if (!configuracoes.chavePix || !configuracoes.nomePix) {
                mostrarAlert('Preencha pelo menos a Chave PIX e o Nome do Recebedor!', 'error');
                return;
            }
            
            mostrarAlert('Configura√ß√µes PIX salvas com sucesso!');
        }

        function carregarLogo(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (!file.type.startsWith('image/')) {
                mostrarAlert('Por favor, selecione apenas arquivos de imagem!', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                configuracoes.urlLogo = e.target.result;
                atualizarInterface();
                atualizarPreview();
                mostrarAlert('Logo carregada com sucesso!');
                
                // Atualizar √°rea de upload
                document.getElementById('upload-text').innerHTML = `
                    <p>‚úÖ Logo carregada!</p>
                    <p style="font-size: 0.9em; color: #666;">Clique para alterar</p>
                `;
            };
            reader.readAsDataURL(file);
        }

        function atualizarInterface() {
            // Atualizar t√≠tulo e subt√≠tulo
            document.getElementById('titulo-empresa').textContent = configuracoes.nomeEmpresa;
            document.getElementById('subtitulo-sistema').textContent = configuracoes.nomeSistema;
            
            // Atualizar logo
            const logoContainer = document.getElementById('logo-container');
            if (configuracoes.urlLogo && configuracoes.urlLogo !== '') {
                logoContainer.innerHTML = `<img src="${configuracoes.urlLogo}" alt="Logo" class="logo-real" onerror="mostrarLogoPlaceholder()">`;
            } else {
                logoContainer.innerHTML = '<div class="logo-placeholder" id="logo-placeholder">BL</div>';
            }
        }

        function mostrarLogoPlaceholder() {
            const logoContainer = document.getElementById('logo-container');
            logoContainer.innerHTML = '<div class="logo-placeholder">BL</div>';
        }

        function atualizarPreview() {
            // Atualizar preview
            document.getElementById('preview-nome-empresa').textContent = configuracoes.nomeEmpresa;
            document.getElementById('preview-nome-sistema').textContent = configuracoes.nomeSistema;
            
            const previewLogo = document.getElementById('preview-logo');
            if (configuracoes.urlLogo && configuracoes.urlLogo !== '') {
                previewLogo.innerHTML = `<img src="${configuracoes.urlLogo}" alt="Logo Preview" style="width: 60px; height: 60px; border-radius: 50%; object-fit: cover; border: 2px solid #DC143C;">`;
            } else {
                previewLogo.innerHTML = '<div class="logo-placeholder" style="width: 60px; height: 60px; font-size: 24px;">BL</div>';
            }
        }

        function testarQRCode() {
            if (!configuracoes.chavePix || !configuracoes.nomePix) {
                mostrarAlert('Configure as informa√ß√µes PIX primeiro!', 'error');
                return;
            }
            
            // Simular gera√ß√£o de QR Code com valor de teste
            const valorTeste = 10.00;
            gerarQRCodePixTeste(valorTeste);
            mostrarAlert('QR Code de teste gerado! (Valor: R$ 10,00)');
        }

        function gerarQRCodePix() {
            if (!configuracoes.chavePix || !configuracoes.nomePix) {
                document.getElementById('qr-code-placeholder').innerHTML = `
                    <div style="color: #DC143C; text-align: center;">
                        <p><strong>Configure o PIX</strong></p>
                        <p>V√° em Ajustes para configurar as informa√ß√µes PIX</p>
                    </div>
                `;
                return;
            }
            
            // Atualizar informa√ß√µes PIX
            document.getElementById('valor-pix').textContent = totalCarrinho.toFixed(2);
            document.getElementById('nome-recebedor-pix').innerHTML = `<strong>Recebedor:</strong> ${configuracoes.nomePix}`;
            
            if (configuracoes.bancoPix) {
                document.getElementById('banco-info-pix').innerHTML = `<p><strong>Banco:</strong> ${configuracoes.bancoPix}</p>`;
            } else {
                document.getElementById('banco-info-pix').innerHTML = '';
            }
            
            // Gerar QR Code usando API p√∫blica
            const pixData = gerarStringPix(configuracoes.chavePix, configuracoes.nomePix, configuracoes.cidadePix, totalCarrinho);
            const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(pixData)}`;
            
            document.getElementById('qr-code-placeholder').innerHTML = `
                <img src="${qrCodeUrl}" alt="QR Code PIX" style="max-width: 100%; border-radius: 10px; border: 3px solid #FFD700;">
            `;
        }

        function gerarQRCodePixTeste(valor) {
            const pixData = gerarStringPix(configuracoes.chavePix, configuracoes.nomePix, configuracoes.cidadePix, valor);
            const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(pixData)}`;
            
            // Mostrar em um modal simples
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.8); z-index: 9999; display: flex;
                align-items: center; justify-content: center;
            `;
            modal.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 15px; text-align: center; max-width: 400px;">
                    <h3 style="color: #DC143C; margin-bottom: 20px;">QR Code PIX - Teste</h3>
                    <img src="${qrCodeUrl}" alt="QR Code Test" style="max-width: 100%; border-radius: 10px;">
                    <p style="margin: 15px 0;"><strong>Valor:</strong> R$ ${valor.toFixed(2)}</p>
                    <p style="margin: 15px 0;"><strong>Recebedor:</strong> ${configuracoes.nomePix}</p>
                    <button onclick="this.parentElement.parentElement.remove()" style="
                        background: #DC143C; color: white; border: none; padding: 10px 20px;
                        border-radius: 5px; cursor: pointer; margin-top: 15px;
                    ">Fechar</button>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function gerarStringPix(chave, nome, cidade, valor) {
            // Fun√ß√£o simplificada para gerar string PIX
            const valorFormatado = valor.toFixed(2);
            return `00020126330014br.gov.bcb.pix0111${chave}52040000530398654${valorFormatado.length.toString().padStart(2, '0')}${valorFormatado}5802BR5913${nome.substring(0, 25)}6009${cidade.substring(0, 15)}62070503***6304`;
        }

        // Fechar modais ao clicar fora
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal-overlay')) {
                e.target.style.display = 'none';
            }
        });

        // Fechar modal de finaliza√ß√£o ao clicar fora
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('modal-finalizacao').addEventListener('click', function(e) {
                if (e.target === this) {
                    fecharModal();
                }
            });
        });

        // Atalhos de teclado
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                // Fechar qualquer modal aberto
                const modals = document.querySelectorAll('.modal-overlay, #modal-finalizacao');
                modals.forEach(modal => {
                    if (modal.style.display !== 'none') {
                        modal.style.display = 'none';
                    }
                });
                
                if (document.getElementById('modal-finalizacao').style.display !== 'none') {
                    fecharModal();
                }
            }
            
            // Ctrl + Enter para finalizar venda rapidamente
            if (e.ctrlKey && e.key === 'Enter') {
                if (document.getElementById('nova-venda').classList.contains('active') && carrinho.length > 0) {
                    finalizarVenda();
                }
            }
        });

        // Inicializar sistema ao carregar a p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            atualizarInterface();
            atualizarPreview();
        });
    </script>
</body>
</html>
